

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Marine Robotics Computer Vision &mdash; Marine Robotics Computer Vision  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=ea7bc319" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Marine Robotics Computer Vision
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Marine Robotics Computer Vision</a></li>
<li><a class="reference internal" href="#id1">Описание служебных структур</a><ul>
<li><a class="reference internal" href="#id2">Перечисления:</a></li>
<li><a class="reference internal" href="#id3">Структуры:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">Модуль служебных функций</a><ul>
<li><a class="reference internal" href="#id5">Функции работы с изображениями</a></li>
<li><a class="reference internal" href="#id6">Функции работы с видео</a></li>
<li><a class="reference internal" href="#id7">Функции калибровки камер</a></li>
<li><a class="reference internal" href="#id8">Функции логирования</a></li>
<li><a class="reference internal" href="#id9">Функции работы с изображениями из интернета</a></li>
<li><a class="reference internal" href="#id10">Функции построения карты диспаратности</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11">Модуль аугментации</a><ul>
<li><a class="reference internal" href="#id12">Функция поворота изображения</a></li>
<li><a class="reference internal" href="#id13">Функция отражения изображения</a></li>
<li><a class="reference internal" href="#id14">Функция аугментации изображений</a></li>
<li><a class="reference internal" href="#id15">Поддерживаемые методы аугментации:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16">Модуль кластеризации</a><ul>
<li><a class="reference internal" href="#id17">Загрузка данных из файла</a></li>
<li><a class="reference internal" href="#id18">Кластеризация загруженных данных</a></li>
<li><a class="reference internal" href="#id19">Печать информации о кластерах</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id20">Модуль сравнения изображений</a><ul>
<li><a class="reference internal" href="#id21">Сравнение изображений</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id22">Модуль детекции изображений</a><ul>
<li><a class="reference internal" href="#id23">Инициализация детектора</a></li>
<li><a class="reference internal" href="#id24">Загрузка предобученной модели</a></li>
<li><a class="reference internal" href="#id25">Обучение модели</a></li>
<li><a class="reference internal" href="#id26">Автоматический подбор гиперпараметров</a></li>
<li><a class="reference internal" href="#id27">Предсказание и визуализация</a><ul>
<li><a class="reference internal" href="#id28">Валидация модели</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id29">Модуль предварительной обработки изображений</a><ul>
<li><a class="reference internal" href="#id30">Функция создания изображения с сообщением об ошибке</a></li>
<li><a class="reference internal" href="#id31">Коррекция яркости изображения</a></li>
<li><a class="reference internal" href="#id32">Увеличение резкости (метод Лапласа)</a></li>
<li><a class="reference internal" href="#id33">Увеличение резкости (метод Гаусса)</a></li>
<li><a class="reference internal" href="#id34">Основная функция предварительной обработки</a></li>
<li><a class="reference internal" href="#id35">Увеличение контраста изображения</a></li>
<li><a class="reference internal" href="#id36">Балансировка контраста</a></li>
<li><a class="reference internal" href="#id37">Расширение контраста</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id38">Модуль морфологических преобразований</a><ul>
<li><a class="reference internal" href="#id39">Основная функция морфологических преобразований</a></li>
<li><a class="reference internal" href="#id40">Функция морфологического открытия</a></li>
<li><a class="reference internal" href="#id41">Функция морфологического закрытия</a></li>
<li><a class="reference internal" href="#id42">Функция морфологического градиента</a></li>
<li><a class="reference internal" href="#id43">Функция морфологической эрозии</a></li>
<li><a class="reference internal" href="#id44">Функция морфологического расширения</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id45">Модуль расчета курса объекта</a><ul>
<li><a class="reference internal" href="#objcourse">Класс ObjCourse</a></li>
<li><a class="reference internal" href="#id46">Инициализация нейронной сети</a></li>
<li><a class="reference internal" href="#id47">Основной процесс обработки</a></li>
<li><a class="reference internal" href="#id48">Расчет курса</a></li>
<li><a class="reference internal" href="#id49">Предобработка изображения</a></li>
<li><a class="reference internal" href="#id50">Постобработка результатов</a></li>
<li><a class="reference internal" href="#id51">Отрисовка меток</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id52">Модуль сегментации изображений</a><ul>
<li><a class="reference internal" href="#fpn">Архитектура FPN</a></li>
<li><a class="reference internal" href="#segmentor">Класс Segmentor</a></li>
<li><a class="reference internal" href="#id53">Вспомогательные классы</a></li>
<li><a class="reference internal" href="#id54">Функции потерь</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d">Модуль создания 3D сцен</a><ul>
<li><a class="reference internal" href="#id55">Формирование стереопары</a></li>
<li><a class="reference internal" href="#id56">Построение карты диспаратности</a></li>
<li><a class="reference internal" href="#id57">Сегментация объектов</a></li>
<li><a class="reference internal" href="#id58">Визуализация 3D сцены</a></li>
<li><a class="reference internal" href="#id59">Сохранение результатов</a></li>
</ul>
</li>
<li><a class="reference internal" href="#yolov5">Модуль работы с YOLOv5</a><ul>
<li><a class="reference internal" href="#id60">Интерактивная разметка данных</a></li>
<li><a class="reference internal" href="#id61">Генерация конфигурации модели</a></li>
<li><a class="reference internal" href="#id62">Генерация гиперпараметров</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id63">Демонстрационные примеры</a><ul>
<li><a class="reference internal" href="#id64">Пример использования аугментации изображений</a></li>
<li><a class="reference internal" href="#id65">Пример использования кластеризации</a></li>
<li><a class="reference internal" href="#id66">Пример использования модуля работы с YOLOv5</a></li>
<li><a class="reference internal" href="#id67">Пример использования детектирования объектов</a></li>
<li><a class="reference internal" href="#id68">Пример использования предобработки изображений</a></li>
<li><a class="reference internal" href="#id69">Пример использования модуля определения курса объекта</a></li>
<li><a class="reference internal" href="#id70">Пример использования модуля 3D сцены</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Marine Robotics Computer Vision</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Marine Robotics Computer Vision</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="marine-robotics-computer-vision">
<h1>Marine Robotics Computer Vision<a class="headerlink" href="#marine-robotics-computer-vision" title="Link to this heading"></a></h1>
<p>добавить описание библиотеки
Открытая библиотека компьютерного зрения для морских робототехнических систем.</p>
<p>Датасет изображений для работы с библиотекой доступен по ссылке:</p>
<p><a class="reference external" href="https://disk.yandex.ru/d/TxReQ9J6PAo9Nw">code-ai-400393-image-dataset.7z</a></p>
</section>
<section id="id1">
<h1>Описание служебных структур<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>Ниже приведены основные структуры, перечисления и параметры, используемые в библиотеке Marine Robotics Computer Vision для хранения данных, настройки алгоритмов и конфигурации камер.</p>
<section id="id2">
<h2>Перечисления:<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p><strong>enum class METOD_MORF</strong> — методы морфологических преобразований:
- <cite>OPEN</cite>, <cite>CLOSE</cite>, <cite>GRADIENT</cite>, <cite>ERODE</cite>, <cite>DILAT</cite></p>
<p><strong>enum class CODEC</strong> — поддерживаемые видео-кодеки:
- <cite>XVID</cite>, <cite>MJPG</cite>, <cite>mp4v</cite>, <cite>h265</cite></p>
<p><strong>enum class LOGTYPE</strong> — типы записей в лог-файл:
- <cite>DEBUG</cite>, <cite>ERROR</cite>, <cite>EXCEPTION</cite>, <cite>INFO</cite>, <cite>WARNING</cite></p>
<p><strong>enum class METOD_INCREASE_IMAGE_CONTRAST</strong> — методы повышения контрастности изображения:
- <cite>EQUALIZE_HIST</cite>, <cite>CLAHE</cite>, <cite>CONTRAST_BALANCING</cite>, <cite>CONTRAST_EXTENSION</cite></p>
<p><strong>enum class COLOR_MODEL</strong> — цветовые модели:
- <cite>CM_RGB</cite>, <cite>CM_HSV</cite>, <cite>CM_LAB</cite>, <cite>CM_YCBCR</cite></p>
<p><strong>enum class METOD_IMAGE_PERPROCESSIN</strong> — методы предобработки изображений:
- <cite>NONE</cite>, <cite>CONVERTING_BGR_TO_GRAY</cite>, … <em>(см. исходный код для полного списка)</em></p>
<p><strong>enum class METOD_DISPARITY</strong> — методы расчёта карты диспаратности:
- <cite>MODE_NONE</cite>, <cite>MODE_BM</cite>, <cite>MODE_SGBM</cite>, <cite>MODE_SGBM_3WAY</cite>, <cite>MODE_HH</cite>, <cite>MODE_HH4</cite></p>
<p><strong>enum class AUGMENTATION_METHOD</strong> — методы аугментации изображений:
- <cite>FLIP_HORIZONTAL</cite>, <cite>FLIP_VERTICAL</cite>, <cite>ROTATE_IMAGE_90</cite>, и др.</p>
<p><strong>enum class DISPARITY_TYPE</strong> — типы выходных данных по диспаратности:
- <cite>ALL</cite>, <cite>BASIC_DISPARITY</cite>, <cite>BASIC_HEATMAP</cite>, и др.</p>
</section>
<section id="id3">
<h2>Структуры:<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p><strong>cameraParameters</strong> — параметры одной камеры</p>
<p><strong>cameraStereoParameters</strong> — параметры стерео-камеры</p>
<p><strong>pointsData</strong> — структура данных для хранения облака точек и их проекций</p>
<p><strong>parameters3dSceene</strong> — параметры построения и отображения 3D сцены</p>
<p><strong>CalibrationParametersMono / Stereo</strong> — результат калибровки камеры</p>
<p><strong>CalibrationConfig</strong> — параметры для загрузки и настройки калибровки</p>
<p><strong>trainTricks</strong> — параметры, влияющие на поведение нейросетевого обучения</p>
<p><strong>settingsMetodDisparity</strong> — параметры алгоритма расчёта карты диспаратности</p>
</section>
</section>
<section id="id4">
<h1>Модуль служебных функций<a class="headerlink" href="#id4" title="Link to this heading"></a></h1>
<p><em>В данном модуле реализованы вспомогательные функции для работы с изображениями, видео, калибровкой камер и логированием.</em></p>
<section id="id5">
<h2>Функции работы с изображениями<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<p><strong>Функция сравнения изображений</strong></p>
<p><em>Сравнивает два изображения и возвращает процент различий.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">compareImages</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img1</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img2</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">methodCompare</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">img1</span></code> - первое изображение для сравнения</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">img2</span></code> - второе изображение для сравнения</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">methodCompare</span></code> - метод сравнения (true/false)</p></li>
</ul>
<p><strong>Возвращает:</strong> процент различий между изображениями</p>
<p><strong>Функция морфологического преобразования</strong></p>
<p><em>Применяет морфологические операции к изображению.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">morphologyImage</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">METOD_MORF</span><span class="w"> </span><span class="n">metod</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">morph_size</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">image</span></code> - входное изображение
- <code class="docutils literal notranslate"><span class="pre">out</span></code> - путь для сохранения результата
- <code class="docutils literal notranslate"><span class="pre">metod</span></code> - тип морфологической операции (OPEN, CLOSE, GRADIENT, ERODE, DILAT)
- <code class="docutils literal notranslate"><span class="pre">morph_size</span></code> - размер ядра преобразования</p>
</section>
<section id="id6">
<h2>Функции работы с видео<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<p><strong>Запись видеопотока</strong></p>
<p><em>Записывает видео с камеры в файл.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">recordVideo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">cameraID</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">recorderInterval</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">CODEC</span><span class="w"> </span><span class="n">codec</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">cameraID</span></code> - идентификатор камеры
- <code class="docutils literal notranslate"><span class="pre">recorderInterval</span></code> - интервал записи в секундах
- <code class="docutils literal notranslate"><span class="pre">fileName</span></code> - имя файла для сохранения
- <code class="docutils literal notranslate"><span class="pre">codec</span></code> - используемый кодек (XVID, MJPG, mp4v, h265)</p>
<p><strong>Возвращает:</strong> код результата (0 - успех)</p>
</section>
<section id="id7">
<h2>Функции калибровки камер<a class="headerlink" href="#id7" title="Link to this heading"></a></h2>
<p><strong>Калибровка одиночной камеры</strong></p>
<p><em>Выполняет калибровку одной камеры по изображениям шахматной доски.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">cameraCalibrationMono</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">images</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathToImages</span><span class="p">,</span>
<span class="w">                               </span><span class="n">CalibrationParametersMono</span><span class="o">&amp;</span><span class="w"> </span><span class="n">calibrationParameters</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">int</span><span class="w"> </span><span class="n">chessboardColCount</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">chessboardRowCount</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">float</span><span class="w"> </span><span class="n">chessboardSquareSize</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">images</span></code> - вектор имен файлов изображений</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pathToImages</span></code> - путь к папке с изображениями</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calibrationParameters</span></code> - структура для хранения параметров калибровки</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chessboardColCount</span></code> - количество углов по горизонтали</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chessboardRowCount</span></code> - количество углов по вертикали</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chessboardSquareSize</span></code> - размер клетки шахматной доски в мм</p></li>
</ul>
<p><strong>Калибровка стереопары</strong></p>
<p><em>Выполняет калибровку стереопары камер.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">cameraCalibrationStereo</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">imagesL</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">imagesR</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathToImagesL</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathToImagesR</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">CalibrationParametersStereo</span><span class="o">&amp;</span><span class="w"> </span><span class="n">calibrationParameters</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">int</span><span class="w"> </span><span class="n">chessboardColCount</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">chessboardRowCount</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">float</span><span class="w"> </span><span class="n">chessboardSquareSize</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imagesL</span></code>, <code class="docutils literal notranslate"><span class="pre">imagesR</span></code> - векторы имен файлов для левой и правой камер</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pathToImagesL</span></code>, <code class="docutils literal notranslate"><span class="pre">pathToImagesR</span></code> - пути к папкам с изображениями</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calibrationParameters</span></code> - структура для хранения параметров калибровки</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chessboardColCount</span></code>, <code class="docutils literal notranslate"><span class="pre">chessboardRowCount</span></code> - количество углов доски</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chessboardSquareSize</span></code> - размер клетки в мм</p></li>
</ul>
</section>
<section id="id8">
<h2>Функции логирования<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<p><strong>Запись в лог-файл</strong></p>
<p><em>Записывает сообщение в лог-файл с указанием типа.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">writeLog</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">logText</span><span class="p">,</span><span class="w"> </span><span class="n">LOGTYPE</span><span class="w"> </span><span class="n">logType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOGTYPE</span><span class="o">::</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">logText</span></code> - текст сообщения</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logType</span></code> - тип сообщения (DEBUG, ERROR, EXCEPTION, INFO, WARNING)</p></li>
</ul>
<p><strong>Генерация уникального имени файла</strong></p>
<p><em>Создает уникальное имя файла на основе текущего времени.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">generateUniqueFileName</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fileExtension</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fileName</span></code> - префикс имени файла</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fileExtension</span></code> - расширение файла</p></li>
</ul>
<p><strong>Возвращает:</strong> строку с уникальным именем файла</p>
</section>
<section id="id9">
<h2>Функции работы с изображениями из интернета<a class="headerlink" href="#id9" title="Link to this heading"></a></h2>
<p><strong>Загрузка изображений с Яндекса</strong></p>
<p><em>Скачивает изображения по запросу из Яндекс.Картинок.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">getImagesFromYandex</span><span class="p">(</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">query</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">minWidth</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">minHeight</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">nameTemplate</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">outputFolder</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">separateDataset</span><span class="p">,</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">trainsetPercentage</span><span class="p">,</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">countFoto</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">money</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">secretKey</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">query</span></code> - строка поискового запроса</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minWidth</span></code>, <code class="docutils literal notranslate"><span class="pre">minHeight</span></code> - минимальные размеры изображений</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nameTemplate</span></code> - шаблон имени файла</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputFolder</span></code> - папка для сохранения</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">separateDataset</span></code> - флаг разделения на train/test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trainsetPercentage</span></code> - процент для обучающей выборки</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">countFoto</span></code> - количество изображений для скачивания</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">money</span></code> - флаг платного API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">secretKey</span></code> - ключи API</p></li>
</ul>
</section>
<section id="id10">
<h2>Функции построения карты диспаратности<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<p><strong>Построение карты диспаратности</strong></p>
<p><em>Строит карту диспаратности для стереопары изображений.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">disparityMap</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">map</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageLeft</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageRight</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">minDisparity</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numDisparities</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">blockSize</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">double</span><span class="w"> </span><span class="n">lambda</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">DISPARITY_TYPE</span><span class="w"> </span><span class="n">disparityType</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">int</span><span class="w"> </span><span class="n">colorMap</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">saveToFile</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">showImages</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">map</span></code> - выходная карта диспаратности</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imageLeft</span></code>, <code class="docutils literal notranslate"><span class="pre">imageRight</span></code> - изображения стереопары</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minDisparity</span></code> - минимальная диспаратность</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numDisparities</span></code> - количество уровней диспаратности</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blockSize</span></code> - размер блока для сравнения</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span></code> - параметры фильтрации</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">disparityType</span></code> - тип выходной карты</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorMap</span></code> - цветовая схема</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveToFile</span></code> - флаг сохранения в файл</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">showImages</span></code> - флаг отображения окон</p></li>
</ul>
<p><strong>Возвращает:</strong> код результата (0 - успех)</p>
</section>
</section>
<section id="id11">
<h1>Модуль аугментации<a class="headerlink" href="#id11" title="Link to this heading"></a></h1>
<p><em>В модуле представлены функции, позволяющие выполнять базовые трансформации изображений, включая поворот, отражение, а также массовую аугментацию.</em></p>
<section id="id12">
<h2>Функция поворота изображения<a class="headerlink" href="#id12" title="Link to this heading"></a></h2>
<p><em>Поворачивает изображение на определённый угол с использованием центральной точки.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">rotateImage</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">angle</span><span class="p">)</span>
</pre></div>
</div>
<p>Описание параметров:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imageInput</span></code> — входное (исходное) изображение <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imageOutput</span></code> — выходное (преобразованное) изображение <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">angle</span></code> — угол поворота в градусах.</p></li>
</ul>
<p><strong>return</strong> — код результата работы функции:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> — успех,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> — пустое изображение,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> — неизвестный формат изображения,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> — неизвестная ошибка.</p></li>
</ul>
</section>
<section id="id13">
<h2>Функция отражения изображения<a class="headerlink" href="#id13" title="Link to this heading"></a></h2>
<p><em>Отражает изображение по горизонтали, вертикали или обеим осям.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">flipImage</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flipCode</span><span class="p">)</span>
</pre></div>
</div>
<p>Описание параметров:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imageInput</span></code> — входное (исходное) изображение <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imageOutput</span></code> — выходное (преобразованное) изображение <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flipCode</span></code> — код отражения:
- <code class="docutils literal notranslate"><span class="pre">0</span></code> — вертикальное отражение
- <code class="docutils literal notranslate"><span class="pre">1</span></code> — горизонтальное отражение
- <code class="docutils literal notranslate"><span class="pre">-1</span></code> — обе стороны</p></li>
</ul>
<p><strong>return</strong> — код результата работы функции:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> — успех,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> — пустое изображение,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> — неизвестный формат изображения,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> — неизвестная ошибка.</p></li>
</ul>
</section>
<section id="id14">
<h2>Функция аугментации изображений<a class="headerlink" href="#id14" title="Link to this heading"></a></h2>
<p><em>Выполняет аугментацию набора входных изображений с использованием заданных методов и сохраняет результаты в директорию.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">augmetation</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">inputImagesAugmetation</span><span class="p">,</span>
<span class="w">                      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">outputImagesAugmetation</span><span class="p">,</span>
<span class="w">                      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">&gt;</span><span class="w"> </span><span class="n">augmetationMethod</span><span class="p">)</span>
</pre></div>
</div>
<p>Описание параметров:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inputImagesAugmetation</span></code> — вектор входных изображений (<code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>) для аугментации.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputImagesAugmetation</span></code> — вектор, в который сохраняются преобразованные изображения.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">augmetationMethod</span></code> — вектор методов аугментации <code class="docutils literal notranslate"><span class="pre">mrcv::AUGMENTATION_METHOD</span></code>.</p></li>
</ul>
<p><strong>return</strong> — код результата работы функции:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> — успех,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> — исключение (OpenCV или файловой системы, или неизвестная ошибка).</p></li>
</ul>
</section>
<section id="id15">
<h2>Поддерживаемые методы аугментации:<a class="headerlink" href="#id15" title="Link to this heading"></a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">AUGMENTATION_METHOD</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NONE</span><span class="p">,</span>
<span class="w">    </span><span class="n">FLIP_HORIZONTAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">FLIP_VERTICAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">FLIP_HORIZONTAL_AND_VERTICAL</span><span class="p">,</span>
<span class="w">    </span><span class="n">ROTATE_IMAGE_90</span><span class="p">,</span>
<span class="w">    </span><span class="n">ROTATE_IMAGE_45</span><span class="p">,</span>
<span class="w">    </span><span class="n">ROTATE_IMAGE_270</span><span class="p">,</span>
<span class="w">    </span><span class="n">ROTATE_IMAGE_315</span><span class="p">,</span>
<span class="w">    </span><span class="n">TEST</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Каждому из методов соответствует операция трансформации изображения с возможностью сохранения результата на диск.</p>
</section>
</section>
<section id="id16">
<h1>Модуль кластеризации<a class="headerlink" href="#id16" title="Link to this heading"></a></h1>
<p><em>В данном модуле реализованы алгоритмы кластеризации 3D-точек, полученных из данных стереокамер. Модуль основан на расчёте евклидовых расстояний между точками и оценке их взаимной близости.</em></p>
<section id="id17">
<h2>Загрузка данных из файла<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<p><em>Загружает координаты 3D-точек из текстового файла и сохраняет их во внутреннюю структуру данных.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">DenseStereo</span><span class="o">::</span><span class="n">loadDataFromFile</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong>
- <code class="docutils literal notranslate"><span class="pre">filename</span></code> — путь к текстовому файлу с координатами.</p>
<p><strong>Назначение:</strong> очищает внутренние данные и заполняет список <code class="docutils literal notranslate"><span class="pre">xyz</span></code> из файла.</p>
</section>
<section id="id18">
<h2>Кластеризация загруженных данных<a class="headerlink" href="#id18" title="Link to this heading"></a></h2>
<p><em>Выполняет кластеризацию точек в 3D пространстве на основе расстояний между ними.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">DenseStereo</span><span class="o">::</span><span class="n">makeClustering</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Назначение:</strong>
- рассчитывает матрицу расстояний между всеми точками,
- нормализует расстояния,
- формирует логическую матрицу близости <code class="docutils literal notranslate"><span class="pre">L</span></code>,
- группирует точки в кластеры,
- присваивает каждой точке индекс её кластера,
- сохраняет результат в файл <code class="docutils literal notranslate"><span class="pre">files/clusters_data.txt</span></code>.</p>
<p><strong>Внутренние параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">IDX</span></code> — вектор, содержащий индексы кластеров для каждой точки.</p>
<p><strong>Промежуточные структуры:</strong> используются многопоточность, нормализация, логические маски.</p>
</section>
<section id="id19">
<h2>Печать информации о кластерах<a class="headerlink" href="#id19" title="Link to this heading"></a></h2>
<p><em>Формирует и записывает в лог информацию о результатах кластеризации.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">DenseStereo</span><span class="o">::</span><span class="n">printClusters</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Назначение:</strong>
- выводит количество точек и количество найденных кластеров в лог.</p>
<p><strong>Тип логирования:</strong>
- <code class="docutils literal notranslate"><span class="pre">LOGTYPE::INFO</span></code></p>
<p>Для хранения результата кластеризации используются поля класса:
- <code class="docutils literal notranslate"><span class="pre">IDX</span></code> — список принадлежности точек к кластерам,
- <code class="docutils literal notranslate"><span class="pre">vuxyzrgb.xyz</span></code> — координаты исходных точек.</p>
</section>
</section>
<section id="id20">
<h1>Модуль сравнения изображений<a class="headerlink" href="#id20" title="Link to this heading"></a></h1>
<p><em>Модуль предназначен для сравнения двух изображений с использованием различных методов. Поддерживаются два режима: сравнение по HSV-гистограммам и по L2-норме между изображениями.</em></p>
<section id="id21">
<h2>Сравнение изображений<a class="headerlink" href="#id21" title="Link to this heading"></a></h2>
<p><em>Выполняет сравнение двух изображений с помощью выбранного метода и возвращает степень их различия.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">compareImages</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img1</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img2</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">methodCompare</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">img1</span></code> — первое входное изображение (cv::Mat).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">img2</span></code> — второе входное изображение (cv::Mat).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">methodCompare</span></code> — флаг выбора метода сравнения:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> — сравнение по HSV-гистограммам,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> — сравнение по L2-норме.</p></li>
</ul>
<p><strong>Назначение:</strong></p>
<ul class="simple">
<li><p>При <code class="docutils literal notranslate"><span class="pre">methodCompare</span> <span class="pre">==</span> <span class="pre">true</span></code>:
- переводит изображения в цветовое пространство HSV,
- вычисляет 2D-гистограммы по каналам Hue и Saturation,
- нормализует гистограммы и сравнивает их методом корреляции (HISTCMP_CORREL).</p></li>
<li><p>При <code class="docutils literal notranslate"><span class="pre">methodCompare</span> <span class="pre">==</span> <span class="pre">false</span></code>:
- вычисляет евклидово расстояние (L2-норма) между изображениями,
- нормализует результат по количеству пикселей.</p></li>
</ul>
<p><strong>Возвращаемое значение:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">double</span></code> — степень схожести изображений:
- при HSV-сравнении: значение корреляции (в диапазоне от -1 до 1),
- при L2-сравнении: значение от <code class="docutils literal notranslate"><span class="pre">0</span></code> (максимальное различие) до <code class="docutils literal notranslate"><span class="pre">1</span></code> (идентичность).</p></li>
</ul>
<p><strong>Промежуточные структуры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hsv1</span></code>, <code class="docutils literal notranslate"><span class="pre">hsv2</span></code> — изображения в HSV-пространстве,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hist1</span></code>, <code class="docutils literal notranslate"><span class="pre">hist2</span></code> — рассчитанные гистограммы для сравнения.</p></li>
</ul>
</section>
</section>
<section id="id22">
<h1>Модуль детекции изображений<a class="headerlink" href="#id22" title="Link to this heading"></a></h1>
<p><em>Модуль реализует полную архитектуру сверточной нейронной сети YOLO для задач детекции объектов. Предусмотрены функции обучения, валидации, предсказания, загрузки весов, работы с аннотациями, подготовки датасета, и визуализации результатов.</em></p>
<section id="id23">
<h2>Инициализация детектора<a class="headerlink" href="#id23" title="Link to this heading"></a></h2>
<p><em>Задает параметры устройства, загружает список меток и подготавливает модель для работы.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">Initialize</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">gpuID</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">nameListPath</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpuID</span></code> — индекс устройства GPU (-1 — использовать CPU).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code> — ширина входного изображения (должна быть кратна 32).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height</span></code> — высота входного изображения (должна быть кратна 32).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nameListPath</span></code> — путь к файлу с названиями классов.</p></li>
</ul>
<p><strong>Назначение:</strong> загружает имена классов, настраивает вычислительное устройство и инициализирует модель <code class="docutils literal notranslate"><span class="pre">YoloBody_tiny</span></code>.</p>
</section>
<section id="id24">
<h2>Загрузка предобученной модели<a class="headerlink" href="#id24" title="Link to this heading"></a></h2>
<p><em>Загружает веса модели из заданного файла.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">LoadPretrained</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pretrainedPath</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Назначение:</strong> частично загружает веса, исключая выходные слои <code class="docutils literal notranslate"><span class="pre">yolo_head</span></code>, и копирует параметры в текущую модель.</p>
</section>
<section id="id25">
<h2>Обучение модели<a class="headerlink" href="#id25" title="Link to this heading"></a></h2>
<p><em>Обучает модель на обучающем датасете.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">Train</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">trainValPath</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">imageType</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="n">numEpochs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">learningRate</span><span class="p">,</span>
<span class="w">                          </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">savePath</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pretrainedPath</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Назначение:</strong></p>
<ul class="simple">
<li><p>загружает датасет в формате XML,</p></li>
<li><p>запускает цикл обучения и валидации,</p></li>
<li><p>на каждом этапе сохраняет веса модели в <code class="docutils literal notranslate"><span class="pre">savePath</span></code>,</p></li>
<li><p>использует функции потерь <code class="docutils literal notranslate"><span class="pre">YOLOLossImpl</span></code>.</p></li>
</ul>
<p><strong>Внутренние зависимости:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DetDataset</span></code> — загрузка и предобработка данных,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOLossImpl</span></code> — расчёт функции потерь,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YoloBody_tiny</span></code> — модель YOLO.</p></li>
</ul>
</section>
<section id="id26">
<h2>Автоматический подбор гиперпараметров<a class="headerlink" href="#id26" title="Link to this heading"></a></h2>
<p><em>Выполняет автоматический перебор комбинаций параметров обучения и выбирает наилучшие.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">AutoTrain</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">trainValPath</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">imageType</span><span class="p">,</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">epochsList</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">batchSizes</span><span class="p">,</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">learningRates</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pretrainedPath</span><span class="p">,</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">savePath</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Назначение:</strong> выбирает комбинацию <code class="docutils literal notranslate"><span class="pre">epochs</span></code>, <code class="docutils literal notranslate"><span class="pre">batchSize</span></code> и <code class="docutils literal notranslate"><span class="pre">learningRate</span></code> с минимальной ошибкой на валидации.</p>
</section>
<section id="id27">
<h2>Предсказание и визуализация<a class="headerlink" href="#id27" title="Link to this heading"></a></h2>
<p><em>Выполняет предсказание объектов на изображении и сохраняет визуализацию.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">Predict</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">show</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">confThresh</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">nmsThresh</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Назначение:</strong></p>
<ul class="simple">
<li><p>выполняет предсказание с использованием модели,</p></li>
<li><p>масштабирует результат обратно к исходному изображению,</p></li>
<li><p>применяет NMS (Non-Maximum Suppression),</p></li>
<li><p>отображает или сохраняет результат визуализации (файл <code class="docutils literal notranslate"><span class="pre">prediction.jpg</span></code>).</p></li>
</ul>
<p><strong>Тип логирования:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LOGTYPE::INFO</span></code> при успешной обработке,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOGTYPE::ERROR</span></code> при ошибках устройства, путей и пр.</p></li>
</ul>
<p><strong>Промежуточные функции:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DecodeBox</span></code> — расшифровка выхода YOLO,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonMaximumSuppression</span></code> — удаление пересекающихся боксов,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">showBbox</span></code> — отображение результатов детекции.</p></li>
</ul>
<section id="id28">
<h3>Валидация модели<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<p><em>Оценивает модель на отложенном датасете и возвращает среднюю ошибку.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">Validate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">valDataPath</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">imageType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batchSize</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Назначение:</strong> используется при автоматическом подборе гиперпараметров и в процессе отладки модели.</p>
</section>
</section>
</section>
<section id="id29">
<h1>Модуль предварительной обработки изображений<a class="headerlink" href="#id29" title="Link to this heading"></a></h1>
<p><em>Данный модуль содержит функции для предварительной обработки изображений, включая коррекцию яркости, контраста, резкости, фильтрацию шумов и геометрическую коррекцию.</em></p>
<section id="id30">
<h2>Функция создания изображения с сообщением об ошибке<a class="headerlink" href="#id30" title="Link to this heading"></a></h2>
<p><em>Создаёт изображение с текстом ошибки для отображения при возникновении проблем.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">getErrorImage</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">textError</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">textError</span></code> - текст сообщения об ошибке.</p></li>
</ul>
<p><strong>Возвращаемое значение:</strong>
- Изображение размером 600x960 с текстом ошибки.</p>
</section>
<section id="id31">
<h2>Коррекция яркости изображения<a class="headerlink" href="#id31" title="Link to this heading"></a></h2>
<p><em>Применяет гамма-коррекцию для изменения яркости изображения.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">changeImageBrightness</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imageInput</span></code> - входное изображение.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imageOutput</span></code> - выходное изображение после коррекции.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code> - параметр гамма-коррекции (значения &lt;1 увеличивают яркость, &gt;1 уменьшают).</p></li>
</ul>
<p><strong>Возвращаемые коды:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - успешное выполнение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - пустое входное изображение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> - необработанное исключение</p></li>
</ul>
</section>
<section id="id32">
<h2>Увеличение резкости (метод Лапласа)<a class="headerlink" href="#id32" title="Link to this heading"></a></h2>
<p><em>Увеличивает резкость изображения с использованием оператора Лапласа.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">sharpeningImage01</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">gainFactorHighFrequencyComponent</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gainFactorHighFrequencyComponent</span></code> - коэффициент усиления высокочастотных компонент.</p></li>
</ul>
<p><strong>Возвращаемые коды:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - успешное выполнение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - пустое входное изображение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> - необработанное исключение</p></li>
</ul>
</section>
<section id="id33">
<h2>Увеличение резкости (метод Гаусса)<a class="headerlink" href="#id33" title="Link to this heading"></a></h2>
<p><em>Увеличивает резкость изображения с использованием размытия по Гауссу.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">sharpeningImage02</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="w"> </span><span class="n">filterSize</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigmaFilter</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">gainFactorHighFrequencyComponent</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filterSize</span></code> - размер ядра фильтра.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigmaFilter</span></code> - параметр размытия.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gainFactorHighFrequencyComponent</span></code> - коэффициент усиления высокочастотных компонент.</p></li>
</ul>
</section>
<section id="id34">
<h2>Основная функция предварительной обработки<a class="headerlink" href="#id34" title="Link to this heading"></a></h2>
<p><em>Применяет последовательность методов обработки к изображению согласно переданному списку.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">preprocessingImage</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">&gt;</span><span class="w"> </span><span class="n">metodImagePerProcessing</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pathToFileCameraParametrs</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Поддерживаемые методы обработки:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONVERTING_BGR_TO_GRAY</span></code> - преобразование в градации серого</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BRIGHTNESS_LEVEL_UP/DOWN</span></code> - коррекция яркости</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BALANCE_CONTRAST_*</span></code> - различные методы коррекции контраста</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SHARPENING_*</span></code> - методы увеличения резкости</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NOISE_FILTERING_*</span></code> - методы фильтрации шумов</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CORRECTION_GEOMETRIC_DEFORMATION</span></code> - геометрическая коррекция</p></li>
</ul>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">metodImagePerProcessing</span></code> - вектор методов обработки для применения.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pathToFileCameraParametrs</span></code> - путь к файлу параметров камеры для геометрической коррекции.</p></li>
</ul>
</section>
<section id="id35">
<h2>Увеличение контраста изображения<a class="headerlink" href="#id35" title="Link to this heading"></a></h2>
<p><em>Применяет различные методы увеличения контраста в разных цветовых пространствах.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">increaseImageContrast</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_INCREASE_IMAGE_CONTRAST</span><span class="w"> </span><span class="n">metodIncreaseContrast</span><span class="p">,</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">COLOR_MODEL</span><span class="w"> </span><span class="n">colorSpace</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">clipLimitCLAHE</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="w"> </span><span class="n">gridSizeCLAHE</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">percentContrastBalance</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">mContrastExtantion</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">eContrastExtantion</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Поддерживаемые методы:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EQUALIZE_HIST</span></code> - эквализация гистограммы</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CLAHE</span></code> - адаптивная эквализация гистограммы</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONTRAST_BALANCING</span></code> - балансировка контраста</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONTRAST_EXTENSION</span></code> - расширение контраста</p></li>
</ul>
<p><strong>Поддерживаемые цветовые пространства:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CM_HSV</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CM_LAB</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CM_YCBCR</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CM_RGB</span></code></p></li>
</ul>
</section>
<section id="id36">
<h2>Балансировка контраста<a class="headerlink" href="#id36" title="Link to this heading"></a></h2>
<p><em>Выполняет балансировку контраста изображения по заданному проценту.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">contrastBalancing</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">planeArray</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">percent</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">percent</span></code> - процент обрезки гистограммы (0-100).</p></li>
</ul>
</section>
<section id="id37">
<h2>Расширение контраста<a class="headerlink" href="#id37" title="Link to this heading"></a></h2>
<p><em>Применяет нелинейное преобразование для расширения динамического диапазона.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">contrastExtantion</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">planeArray</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> - среднее значение (если &lt;0, вычисляется автоматически)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - параметр экспоненты</p></li>
</ul>
</section>
</section>
<section id="id38">
<h1>Модуль морфологических преобразований<a class="headerlink" href="#id38" title="Link to this heading"></a></h1>
<p><em>Данный модуль содержит функции для выполнения морфологических операций над изображениями, включая открытие, закрытие, эрозию, расширение и градиент.</em></p>
<section id="id39">
<h2>Основная функция морфологических преобразований<a class="headerlink" href="#id39" title="Link to this heading"></a></h2>
<p><em>Применяет выбранную морфологическую операцию к изображению.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">morphologyImage</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_MORF</span><span class="w"> </span><span class="n">metod</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">morph_size</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">image</span></code> - входное изображение для обработки</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out</span></code> - путь для сохранения результата</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metod</span></code> - тип морфологической операции:
- <code class="docutils literal notranslate"><span class="pre">OPEN</span></code> - открытие
- <code class="docutils literal notranslate"><span class="pre">CLOSE</span></code> - закрытие
- <code class="docutils literal notranslate"><span class="pre">DILAT</span></code> - расширение
- <code class="docutils literal notranslate"><span class="pre">ERODE</span></code> - эрозия
- <code class="docutils literal notranslate"><span class="pre">GRADIENT</span></code> - градиент</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">morph_size</span></code> - размер структурного элемента</p></li>
</ul>
<p><strong>Возвращаемое значение:</strong>
- 0 - успешное выполнение</p>
</section>
<section id="id40">
<h2>Функция морфологического открытия<a class="headerlink" href="#id40" title="Link to this heading"></a></h2>
<p><em>Выполняет операцию открытия (эрозия с последующим расширением).</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">openingMorphological</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Описание параметров:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">element</span></code> - структурный элемент для операции</p></li>
</ul>
</section>
<section id="id41">
<h2>Функция морфологического закрытия<a class="headerlink" href="#id41" title="Link to this heading"></a></h2>
<p><em>Выполняет операцию закрытия (расширение с последующей эрозией).</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">closingMorphological</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id42">
<h2>Функция морфологического градиента<a class="headerlink" href="#id42" title="Link to this heading"></a></h2>
<p><em>Выполняет операцию морфологического градиента (разница между расширением и эрозией).</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">gradientMorphological</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id43">
<h2>Функция морфологической эрозии<a class="headerlink" href="#id43" title="Link to this heading"></a></h2>
<p><em>Выполняет операцию эрозии (сужение светлых областей).</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">erodeMorphological</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id44">
<h2>Функция морфологического расширения<a class="headerlink" href="#id44" title="Link to this heading"></a></h2>
<p><em>Выполняет операцию расширения (расширение светлых областей).</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">dilationMorphological</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
<p>Все функции:</p>
<ol class="arabic simple">
<li><p>Создают структурный элемент заданного размера</p></li>
<li><p>Применяют соответствующую морфологическую операцию</p></li>
<li><p>Сохраняют результат по указанному пути</p></li>
<li><p>Возвращают 0 при успешном выполнении</p></li>
</ol>
<p><strong>Типы структурных элементов:</strong></p>
<ul class="simple">
<li><p>Используется прямоугольный элемент (MORPH_RECT)</p></li>
<li><p>Размер элемента вычисляется как 2*morph_size + 1</p></li>
</ul>
</section>
</section>
<section id="id45">
<h1>Модуль расчета курса объекта<a class="headerlink" href="#id45" title="Link to this heading"></a></h1>
<p><em>Данный модуль реализует функционал для детекции объектов и расчета курса движения относительно обнаруженных целей с использованием нейронных сетей.</em></p>
<section id="objcourse">
<h2>Класс ObjCourse<a class="headerlink" href="#objcourse" title="Link to this heading"></a></h2>
<p><strong>Основные функции:</strong></p>
</section>
<section id="id46">
<h2>Инициализация нейронной сети<a class="headerlink" href="#id46" title="Link to this heading"></a></h2>
<p><em>Загружает модель нейронной сети и файл с классами объектов.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">initNN</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathToModel</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathToClasses</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">pathToModel</span></code> - путь к файлу модели ONNX
- <code class="docutils literal notranslate"><span class="pre">pathToClasses</span></code> - путь к файлу с классами объектов</p>
<p><strong>Возвращаемые значения:</strong>
- 0 - успешная инициализация
- ENETDOWN - ошибка загрузки модели
- ENOENT - ошибка загрузки файла классов</p>
</section>
<section id="id47">
<h2>Основной процесс обработки<a class="headerlink" href="#id47" title="Link to this heading"></a></h2>
<p><em>Выполняет полный цикл обработки изображения: предобработку, детекцию и постобработку.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">mainProcess</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Возвращаемое значение:</strong>
- Обработанное изображение с отмеченными объектами</p>
</section>
<section id="id48">
<h2>Расчет курса<a class="headerlink" href="#id48" title="Link to this heading"></a></h2>
<p><em>Определяет угол между центром кадра и обнаруженным объектом.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">getObjectCourse</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">frame</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">frameWidth</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">cameraAngle</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">frame</span></code> - входное изображение
- <code class="docutils literal notranslate"><span class="pre">frameWidth</span></code> - ширина кадра
- <code class="docutils literal notranslate"><span class="pre">cameraAngle</span></code> - угол обзора камеры</p>
<p><strong>Возвращаемое значение:</strong>
- Угол отклонения объекта от центра (в градусах)</p>
<p><strong>Вспомогательные функции:</strong></p>
</section>
<section id="id49">
<h2>Предобработка изображения<a class="headerlink" href="#id49" title="Link to this heading"></a></h2>
<p><em>Подготавливает изображение для подачи в нейронную сеть.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">preProcess</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">dnn</span><span class="o">::</span><span class="n">Net</span><span class="o">&amp;</span><span class="w"> </span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id50">
<h2>Постобработка результатов<a class="headerlink" href="#id50" title="Link to this heading"></a></h2>
<p><em>Анализирует выход нейронной сети и выделяет обнаруженные объекты.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">postProcess</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">outputs</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">classNames</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id51">
<h2>Отрисовка меток<a class="headerlink" href="#id51" title="Link to this heading"></a></h2>
<p><em>Добавляет подписи к обнаруженным объектам на изображении.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">ObjCourse</span><span class="o">::</span><span class="n">drawLabel</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">top</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Технические параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_inputWidth</span></code>, <code class="docutils literal notranslate"><span class="pre">_inputHeight</span></code> - размеры входного изображения для нейросети</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_scoreThreshold</span></code> - порог уверенности для детекции</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_nmsThreshold</span></code> - порог для подавления немаксимумов</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_confidenceThreshold</span></code> - минимальный уровень достоверности</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_cameraAngle</span></code> - угол обзора камеры</p></li>
</ul>
</section>
</section>
<section id="id52">
<h1>Модуль сегментации изображений<a class="headerlink" href="#id52" title="Link to this heading"></a></h1>
<p><em>Модуль реализует функционал семантической сегментации изображений с использованием архитектуры FPN (Feature Pyramid Network) на базе предобученных моделей ResNet.</em></p>
<section id="fpn">
<h2>Архитектура FPN<a class="headerlink" href="#fpn" title="Link to this heading"></a></h2>
<p><strong>FPNImpl</strong> - основной класс, реализующий архитектуру Feature Pyramid Network.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FPNImpl</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">torch</span><span class="o">::</span><span class="n">nn</span><span class="o">::</span><span class="n">Module</span>
</pre></div>
</div>
<p><strong>Компоненты:</strong>
- Энкодер (ResNet) для извлечения признаков
- Декодер для построения пирамиды признаков
- Голова сегментации для генерации масок</p>
<p><strong>Инициализация:</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FPNImpl</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_numberClasses</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">encoderName</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pretrainedPath</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">encoderDepth</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">decoderChannelPyramid</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">decoderChannelsSegmentation</span><span class="p">,</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">decoderMergePolicy</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">decoder_dropout</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">upsampling</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">_numberClasses</span></code> - количество классов сегментации
- <code class="docutils literal notranslate"><span class="pre">encoderName</span></code> - имя модели энкодера (resnet18, resnet34, resnet50)
- <code class="docutils literal notranslate"><span class="pre">pretrainedPath</span></code> - путь к предобученным весам
- <code class="docutils literal notranslate"><span class="pre">encoderDepth</span></code> - глубина энкодера (3-5)</p>
</section>
<section id="segmentor">
<h2>Класс Segmentor<a class="headerlink" href="#segmentor" title="Link to this heading"></a></h2>
<p><strong>Основной интерфейс для работы с сегментацией:</strong></p>
<p><strong>Инициализация</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">Segmentor</span><span class="o">::</span><span class="n">Initialize</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">gpu_id</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_height</span><span class="p">,</span>
<span class="w">                         </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;&amp;</span><span class="w"> </span><span class="n">_listName</span><span class="p">,</span>
<span class="w">                         </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">encoderName</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pretrainedPath</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">gpu_id</span></code> - идентификатор GPU (-1 для CPU)
- <code class="docutils literal notranslate"><span class="pre">_width</span></code>, <code class="docutils literal notranslate"><span class="pre">_height</span></code> - размеры входного изображения
- <code class="docutils literal notranslate"><span class="pre">_listName</span></code> - список классов сегментации
- <code class="docutils literal notranslate"><span class="pre">encoderName</span></code> - имя модели энкодера
- <code class="docutils literal notranslate"><span class="pre">pretrainedPath</span></code> - путь к предобученным весам</p>
<p><strong>Обучение модели</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">Segmentor</span><span class="o">::</span><span class="n">Train</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">learning_rate</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">epochs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batch_size</span><span class="p">,</span>
<span class="w">                    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">train_val_path</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">imageType</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">save_path</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры обучения:</strong>
- <code class="docutils literal notranslate"><span class="pre">learning_rate</span></code> - начальная скорость обучения
- <code class="docutils literal notranslate"><span class="pre">epochs</span></code> - количество эпох
- <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> - размер батча
- <code class="docutils literal notranslate"><span class="pre">train_val_path</span></code> - путь к данным обучения/валидации
- <code class="docutils literal notranslate"><span class="pre">imageType</span></code> - расширение изображений (“.jpg”, “.png”)
- <code class="docutils literal notranslate"><span class="pre">save_path</span></code> - путь для сохранения модели</p>
<p><strong>Загрузка весов</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">Segmentor</span><span class="o">::</span><span class="n">LoadWeight</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pathWeight</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Предсказание</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">Segmentor</span><span class="o">::</span><span class="n">Predict</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">which_class</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong>
- <code class="docutils literal notranslate"><span class="pre">image</span></code> - входное изображение
- <code class="docutils literal notranslate"><span class="pre">which_class</span></code> - имя класса для визуализации</p>
</section>
<section id="id53">
<h2>Вспомогательные классы<a class="headerlink" href="#id53" title="Link to this heading"></a></h2>
<p><strong>SegDataset</strong>
<em>Класс для работы с данными сегментации</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SegDataset</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">torch</span><span class="o">::</span><span class="n">data</span><span class="o">::</span><span class="n">Dataset</span><span class="o">&lt;</span><span class="n">SegDataset</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>Функционал:</strong>
- Загрузка изображений и масок
- Аугментация данных
- Преобразование в тензоры</p>
<p><strong>Augmentations</strong></p>
<p><em>Класс для аугментации данных</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Augmentations</span>
</pre></div>
</div>
<p><strong>Методы:</strong>
- <code class="docutils literal notranslate"><span class="pre">Resize</span></code> - изменение размера изображения и маски</p>
</section>
<section id="id54">
<h2>Функции потерь<a class="headerlink" href="#id54" title="Link to this heading"></a></h2>
<p><strong>DiceLoss</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">DiceLoss</span><span class="p">(</span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">prediction</span><span class="p">,</span><span class="w"> </span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">classNum</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>CELoss</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">CELoss</span><span class="p">(</span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">prediction</span><span class="p">,</span><span class="w"> </span><span class="n">torch</span><span class="o">::</span><span class="n">Tensor</span><span class="w"> </span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="d">
<h1>Модуль создания 3D сцен<a class="headerlink" href="#d" title="Link to this heading"></a></h1>
<p><em>Модуль предоставляет функционал для обработки стереоизображений, построения 3D сцен и работы с облаками точек. Включает методы калибровки, построения карт диспаратности, сегментации объектов и визуализации.</em></p>
<section id="id55">
<h2>Формирование стереопары<a class="headerlink" href="#id55" title="Link to this heading"></a></h2>
<p><em>Объединяет изображения с двух камер в единое изображение для обработки.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">makingStereoPair</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">inputImageCamera01</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">inputImageCamera02</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">outputStereoPair</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inputImageCamera01</span></code> - изображение с левой камеры (CV_8UC3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inputImageCamera02</span></code> - изображение с правой камеры (CV_8UC3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputStereoPair</span></code> - результирующее объединенное изображение</p></li>
</ul>
<p><strong>Возвращаемые значения:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - успех</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - пустое изображение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> - ошибка</p></li>
</ul>
<p><strong>Особенности:</strong></p>
<ul class="simple">
<li><p>Автоматический расчет размеров выходного изображения</p></li>
<li><p>Горизонтальное объединение изображений</p></li>
<li><p>Поддержка разных размеров входных изображений</p></li>
</ul>
</section>
<section id="id56">
<h2>Построение карты диспаратности<a class="headerlink" href="#id56" title="Link to this heading"></a></h2>
<p><em>Вычисляет карту различий между стереоизображениями.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">find3dPointsADS</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">inputImageCamera01</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">inputImageCamera02</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">pointsData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">points3D</span><span class="p">,</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">settingsMetodDisparity</span><span class="o">&amp;</span><span class="w"> </span><span class="n">settingsMetodDisparity</span><span class="p">,</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">disparityMap</span><span class="p">,</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">cameraStereoParameters</span><span class="o">&amp;</span><span class="w"> </span><span class="n">cameraParameters</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">limitOutPoints</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">limitsOutlierArea</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Методы построения:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MODE_BM</span></code> - блочное сопоставление (быстрый)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MODE_SGBM</span></code> - полуглобальное сопоставление</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MODE_HH</span></code> - двухпроходный алгоритм</p></li>
</ul>
<p><strong>Особенности:</strong></p>
<ul class="simple">
<li><p>Фильтрация выбросов по заданной области</p></li>
<li><p>Ограничение количества выходных точек</p></li>
<li><p>Поддержка различных цветовых карт</p></li>
</ul>
</section>
<section id="id57">
<h2>Сегментация объектов<a class="headerlink" href="#id57" title="Link to this heading"></a></h2>
<p><em>Обнаружение и сегментация объектов нейронной сетью.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">detectingSegmentsNeuralNet</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageInput</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageOutput</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">replyMasks</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">filePathToModelYoloNeuralNet</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">filePathToClasses</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Особенности:</strong></p>
<ul class="simple">
<li><p>Использование модели YOLO</p></li>
<li><p>Возврат бинарных масок объектов</p></li>
<li><p>Настройка порогов уверенности</p></li>
<li><p>Морфологическая постобработка масок</p></li>
</ul>
</section>
<section id="id58">
<h2>Визуализация 3D сцены<a class="headerlink" href="#id58" title="Link to this heading"></a></h2>
<p><em>Проецирование 3D точек на 2D изображение.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">getImage3dSceene</span><span class="p">(</span><span class="n">mrcv</span><span class="o">::</span><span class="n">pointsData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">points3D</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">parameters3dSceene</span><span class="o">&amp;</span><span class="w"> </span><span class="n">parameters3dSceene</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">cameraStereoParameters</span><span class="o">&amp;</span><span class="w"> </span><span class="n">cameraParameters</span><span class="p">,</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">outputImage3dSceene</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры сцены:</strong></p>
<ul class="simple">
<li><p>Углы поворота (angX/Y/Z)</p></li>
<li><p>Смещение (tX/Y/Z)</p></li>
<li><p>Масштаб (scale)</p></li>
<li><p>Расстояние до центра (dZ)</p></li>
</ul>
</section>
<section id="id59">
<h2>Сохранение результатов<a class="headerlink" href="#id59" title="Link to this heading"></a></h2>
<p><em>Экспорт данных о 3D точках.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">saveInFile3dPointsInObjectsSegments</span><span class="p">(</span><span class="n">pointsData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">points3D</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">pathToFile</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Формат данных:</strong></p>
<ul class="simple">
<li><p>Координаты пикселей и 3D координаты</p></li>
<li><p>Цвет точек</p></li>
<li><p>Идентификаторы сегментов</p></li>
</ul>
</section>
</section>
<section id="yolov5">
<h1>Модуль работы с YOLOv5<a class="headerlink" href="#yolov5" title="Link to this heading"></a></h1>
<p><em>Модуль предоставляет инструменты для работы с моделями YOLOv5, включая интерактивную разметку данных, генерацию конфигурационных файлов и настройку гиперпараметров.</em></p>
<section id="id60">
<h2>Интерактивная разметка данных<a class="headerlink" href="#id60" title="Link to this heading"></a></h2>
<p><em>Инструмент для создания разметки объектов на изображениях в формате YOLO.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">YOLOv5LabelerProcessing</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inputDir</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outputDir</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inputDir</span></code> - путь к директории с исходными изображениями</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputDir</span></code> - путь для сохранения файлов разметки</p></li>
</ul>
<p><strong>Функционал:</strong></p>
<ul class="simple">
<li><p>Поддержка форматов JPG и PNG</p></li>
<li><p>Интерактивный интерфейс с возможностью:
- Рисования bounding box’ов
- Редактирования существующих рамок
- Изменения класса объектов
- Удаления ошибочных разметок</p></li>
<li><p>Автоматическое сохранение в YOLO-формате (нормализованные координаты)</p></li>
</ul>
</section>
<section id="id61">
<h2>Генерация конфигурации модели<a class="headerlink" href="#id61" title="Link to this heading"></a></h2>
<p><em>Создание конфигурационного файла модели YOLOv5 в формате YAML.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">YOLOv5GenerateConfig</span><span class="p">(</span><span class="n">YOLOv5Model</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outputFile</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Поддерживаемые модели:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOv5n</span></code> - nano (наименьшая)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOv5s</span></code> - small</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOv5m</span></code> - medium</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOv5l</span></code> - large</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YOLOv5x</span></code> - extra large</p></li>
</ul>
<p><strong>Содержимое конфига:</strong></p>
<ul class="simple">
<li><p>Параметры масштабирования (depth/width multiple)</p></li>
<li><p>Якорные рамки (anchors)</p></li>
<li><p>Архитектура backbone и head сети</p></li>
<li><p>Количество классов (nc)</p></li>
</ul>
</section>
<section id="id62">
<h2>Генерация гиперпараметров<a class="headerlink" href="#id62" title="Link to this heading"></a></h2>
<p><em>Создание файла с оптимальными гиперпараметрами для обучения.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">YOLOv5GenerateHyperparameters</span><span class="p">(</span><span class="n">YOLOv5Model</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">imgWidth</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">imgHeight</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outputFile</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Настраиваемые параметры:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">weight_decay</span></code> - коэффициент регуляризации</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">box/cls/obj</span></code> - веса для разных компонентов loss-функции</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anchor_t</span></code> - порог для якорных рамок</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fl_gamma</span></code> - параметр focal loss</p></li>
</ul>
<p><strong>Особенности:</strong></p>
<ul class="simple">
<li><p>Автоматическая адаптация под:
- Размер модели
- Разрешение изображений
- Количество классов</p></li>
<li><p>Сохранение в YAML-формате</p></li>
</ul>
</section>
</section>
<section id="id63">
<h1>Демонстрационные примеры<a class="headerlink" href="#id63" title="Link to this heading"></a></h1>
<section id="id64">
<h2>Пример использования аугментации изображений<a class="headerlink" href="#id64" title="Link to this heading"></a></h2>
<p>Модуль включает три основных этапа обработки данных: загрузку изображений, указание методов аугментации, сохранение результатов преобразования.
На первом этапе осуществляется загрузка входных изображений в вектор с использованием функции <code class="docutils literal notranslate"><span class="pre">cv::imread</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputImagesAugmetation</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">inputImagesAugmetation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;files</span><span class="se">\\</span><span class="s">img0.jpg&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
<span class="n">inputImagesAugmetation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;files</span><span class="se">\\</span><span class="s">img1.jpg&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">inputImagesAugmetation</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;files</span><span class="se">\\</span><span class="s">img9.jpg&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
</pre></div>
</div>
<p>На этапе задания методов аугментации задаются названия методов, которые будут применяться к входным изображениям. В качестве методов преобразования могут выступать: поворот изображения на 45, 90, 270 или 315 градусов; зеркальное отображение по горизонтали, вертикали или по обоим направлениям.
Ниже приведены методы аугментации изображений:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">&gt;</span><span class="w"> </span><span class="n">augmetationMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">ROTATE_IMAGE_90</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">FLIP_HORIZONTAL</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">FLIP_VERTICAL</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">ROTATE_IMAGE_45</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">ROTATE_IMAGE_315</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">ROTATE_IMAGE_270</span><span class="p">,</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">AUGMENTATION_METHOD</span><span class="o">::</span><span class="n">FLIP_HORIZONTAL_AND_VERTICAL</span><span class="p">};</span>
</pre></div>
</div>
<p>Далее осуществляется вызов функции аугментации в формате</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">augmetation</span><span class="p">(</span><span class="n">inputImagesAugmetation</span><span class="p">,</span><span class="w"> </span><span class="n">outputImagesAugmetation</span><span class="p">,</span><span class="w"> </span><span class="n">augmetationMethod</span><span class="p">);</span>
</pre></div>
</div>
<p>После выполнения всех операций, модифицированные изображения сохраняются на диск с использованием функции <code class="docutils literal notranslate"><span class="pre">cv::imwrite(ss.str(),</span> <span class="pre">resultImage)</span></code></p>
<p>Результат работы функции аугментации :</p>
<a class="inline-images reference internal image-reference" href="_images/augmentation1.jpg"><img alt="Пример результата обработки" class="inline-images" src="_images/augmentation1.jpg" style="width: 200px;" />
</a>
<a class="reference internal image-reference" href="_images/augmentation2.jpg"><img alt="Пример результата обработки" src="_images/augmentation2.jpg" style="width: 200px;" />
</a>
<a class="reference internal image-reference" href="_images/augmentation3.jpg"><img alt="Пример результата обработки" src="_images/augmentation3.jpg" style="width: 200px;" />
</a>
</section>
<section id="id65">
<h2>Пример использования кластеризации<a class="headerlink" href="#id65" title="Link to this heading"></a></h2>
<p><em>Реализует алгоритмы кластеризации 3D-точек на основе данных стереокамер.</em></p>
<p><strong>Загрузка данных</strong></p>
<p><em>Загружает данные для кластеризации из файла.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">DenseStereo</span><span class="o">::</span><span class="n">loadDataFromFile</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Выполнение кластеризации</strong></p>
<p><em>Выполняет кластеризацию загруженных данных.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">DenseStereo</span><span class="o">::</span><span class="n">makeClustering</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id66">
<h2>Пример использования модуля работы с YOLOv5<a class="headerlink" href="#id66" title="Link to this heading"></a></h2>
<p><em>Генерация конфигурационного файла для YOLOv5s с 80 классами представлена ниже</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">try</span>
<span class="p">{</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">YOLOv5GenerateHyperparameters</span><span class="p">(</span><span class="n">mrcv</span><span class="o">::</span><span class="n">YOLOv5Model</span><span class="o">::</span><span class="n">YOLOv5s</span><span class="p">,</span>
<span class="w">                                          </span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yolov5s-hyp.yaml&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ex</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Error: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>При успешной генерации без исключений, содержимое созданного конфигурационного файла <em>yolov5s-hyp.yaml</em> приведено ниже:</p>
<p><code class="docutils literal notranslate"><span class="pre">weight_decay:</span> <span class="pre">0.00050000000000000001</span></code>
<code class="docutils literal notranslate"><span class="pre">box:</span> <span class="pre">0.075000000000000011</span></code>
<code class="docutils literal notranslate"><span class="pre">cls:</span> <span class="pre">0.52500000000000002</span></code>
<code class="docutils literal notranslate"><span class="pre">cls_pw:</span> <span class="pre">1</span></code>
<code class="docutils literal notranslate"><span class="pre">obj:</span> <span class="pre">1</span></code>
<code class="docutils literal notranslate"><span class="pre">obj_pw:</span> <span class="pre">1</span></code>
<code class="docutils literal notranslate"><span class="pre">anchor_t:</span> <span class="pre">4</span></code>
<code class="docutils literal notranslate"><span class="pre">fl_gamma:</span> <span class="pre">0.17004397181410924</span></code>
Здесь можно заметить обозначенные ранее параметры, которые необходимы для обучения моделей детекторов и классификаторов <em>YOLOv5</em>.</p>
</section>
<section id="id67">
<h2>Пример использования детектирования объектов<a class="headerlink" href="#id67" title="Link to this heading"></a></h2>
<p><em>Реализует функционал для автоматического обучения детектора объектов.</em></p>
<p><strong>Инициализация детектора</strong></p>
<p><em>Инициализирует детектор с заданными параметрами.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">Initialize</span><span class="p">(</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">device</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">classesFile</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Автоматическое обучение</strong></p>
<p><em>Выполняет автоматическое обучение модели детектора.</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">Detector</span><span class="o">::</span><span class="n">AutoTrain</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">datasetPath</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">imageExtension</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">epochs</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">batchSizes</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">learningRates</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pretrainedModel</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">outputModel</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id68">
<h2>Пример использования предобработки изображений<a class="headerlink" href="#id68" title="Link to this heading"></a></h2>
<p>Для подготовки входных параметров функции предобработки <code class="docutils literal notranslate"><span class="pre">preprocessingImage()</span></code> производится загрузка исходного изображения:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">imageIn</span><span class="p">;</span>
<span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">imageOut</span><span class="p">;</span>
<span class="n">imageIn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;./files/seabed.png&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
<span class="n">imageOut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imageIn</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">writeLog</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s"> imageIn channels = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">imageIn</span><span class="p">.</span><span class="n">channels</span><span class="p">()));</span>
</pre></div>
</div>
<p>Формируется список применяемых методов предобработки:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">&gt;</span><span class="w"> </span><span class="n">metodImagePerProcessinBrightnessContrast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">NOISE_FILTERING_01_MEDIAN_FILTER</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">BALANCE_CONTRAST_10_LAB_CLAHE</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">SHARPENING_02</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">BRIGHTNESS_LEVEL_DOWN</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">NONE</span><span class="p">,</span>
<span class="w">    </span><span class="n">mrcv</span><span class="o">::</span><span class="n">METOD_IMAGE_PERPROCESSIN</span><span class="o">::</span><span class="n">CORRECTION_GEOMETRIC_DEFORMATION</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Далее, применяется функция предобработки:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">preprocessingImage</span><span class="p">(</span><span class="n">imageOut</span><span class="p">,</span><span class="w"> </span><span class="n">metodImagePerProcessin</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;./files/fileCameraParameters.xml&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Сохранение результата в файл:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">imageOutputFilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;./files/outImages/test.png&quot;</span><span class="p">;</span>
<span class="n">cv</span><span class="o">::</span><span class="n">imwrite</span><span class="p">(</span><span class="n">imageOutputFilePath</span><span class="p">,</span><span class="w"> </span><span class="n">imageOut</span><span class="p">);</span>
<span class="n">mrcv</span><span class="o">::</span><span class="n">writeLog</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s"> результат преодобработки сохранён: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">imageOutputFilePath</span><span class="p">);</span>
</pre></div>
</div>
<p>Отображение результатов на экране:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="n">CoefShowWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="n">cv</span><span class="o">::</span><span class="n">resize</span><span class="p">(</span><span class="n">imageIn</span><span class="p">,</span><span class="w"> </span><span class="n">imageIn</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="kt">double</span><span class="p">(</span><span class="n">imageIn</span><span class="p">.</span><span class="n">cols</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CoefShowWindow</span><span class="p">),</span>
<span class="w">                                      </span><span class="kt">double</span><span class="p">(</span><span class="n">imageIn</span><span class="p">.</span><span class="n">rows</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CoefShowWindow</span><span class="p">)),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">INTER_LINEAR</span><span class="p">);</span>
<span class="n">cv</span><span class="o">::</span><span class="n">resize</span><span class="p">(</span><span class="n">imageOut</span><span class="p">,</span><span class="w"> </span><span class="n">imageOut</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="kt">double</span><span class="p">(</span><span class="n">imageOut</span><span class="p">.</span><span class="n">cols</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CoefShowWindow</span><span class="p">),</span>
<span class="w">                                        </span><span class="kt">double</span><span class="p">(</span><span class="n">imageOut</span><span class="p">.</span><span class="n">rows</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CoefShowWindow</span><span class="p">)),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">INTER_LINEAR</span><span class="p">);</span>
<span class="n">cv</span><span class="o">::</span><span class="n">namedWindow</span><span class="p">(</span><span class="s">&quot;imageIn&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">WINDOW_AUTOSIZE</span><span class="p">);</span>
<span class="n">imshow</span><span class="p">(</span><span class="s">&quot;imageIn&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">imageIn</span><span class="p">);</span>
<span class="n">cv</span><span class="o">::</span><span class="n">namedWindow</span><span class="p">(</span><span class="s">&quot;imageOut&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">WINDOW_AUTOSIZE</span><span class="p">);</span>
<span class="n">imshow</span><span class="p">(</span><span class="s">&quot;imageOut&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">imageOut</span><span class="p">);</span>
<span class="n">cv</span><span class="o">::</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>Результаты предобработки подводных изображений:</p>
<a class="reference internal image-reference" href="_images/preprocessing.jpg"><img alt="Исходное изображение, результат предобработки" class="align-center" src="_images/preprocessing.jpg" style="width: 200px;" />
</a>
<p>Пример фрагмента log-файла во время запуска примера:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>16:59:43 | INFO |  === НОВЫЙ ЗАПУСК ===
16:59:43 | INFO | загружено изображение: ./files/img02.jfif :: 960x600x3
16:59:43 | INFO | imageIn.channels = 3
16:59:43 | INFO | NOISE_FILTERING_01_MEDIAN_FILTER, state = 0
16:59:43 | INFO | BALANCE_CONTRAST_10_LAB_CLAHE, state = 0
16:59:43 | INFO | SHARPENING_02, state = 0
16:59:43 | INFO | BRIGHTNESS_LEVEL_DOWN, state = 0
16:59:43 | INFO | CORRECTION_GEOMETRIC_DEFORMATION, state = 0
16:59:43 | INFO | Предобработка изображения завершена (успешно)
16:59:43 | INFO | результат предобработки сохранён: ./files/img02.jfif
</pre></div>
</div>
</section>
<section id="id69">
<h2>Пример использования модуля определения курса объекта<a class="headerlink" href="#id69" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>ship.bmp – кадр видеоряда с объектом интереса на изображении;</p></li>
<li><p>ship.onnx – обученная модель в формате YOLO5;</p></li>
<li><p>ship.names – текстовый файл с именами классов объектов интереса.</p></li>
</ul>
<p>Создание экземпляра класса осуществляется с помощью вызова конструктора:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mrcv</span><span class="o">::</span><span class="n">ObjCourse</span><span class="w"> </span><span class="o">*</span><span class="n">objcourse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">ObjCourse</span><span class="p">(</span><span class="n">modelPath</span><span class="p">.</span><span class="n">u8string</span><span class="p">(),</span><span class="w"> </span><span class="n">classPath</span><span class="p">.</span><span class="n">u8string</span><span class="p">());</span>
</pre></div>
</div>
<p>В качестве входных данных конструктор принимает полный путь к модели, полный путь к файлу с классами модели и размеры детектора.</p>
<p>Тестирование проводилось на синтетическом изображении — модели кадра видеопотока, содержащего объект интереса.
Режим отображения меток используется только в режиме отладки при включенном флаге <code class="docutils literal notranslate"><span class="pre">IS_DEBUG_LOG_ENABLED</span></code>.</p>
<p>Результат работы детектора:</p>
<a class="reference internal image-reference" href="_images/objcourse_result.jpg"><img alt="Тестовое изображение с результатом работы" src="_images/objcourse_result.jpg" style="width: 200px;" />
</a>
<p>Для выполнения основных функций модуля используются вызовы методов класса <code class="docutils literal notranslate"><span class="pre">ObjCourse</span></code>, как показано ниже.
Подразумевается, что тестовое изображение предварительно загружено в переменную <code class="docutils literal notranslate"><span class="pre">cv::Mat</span> <span class="pre">frameShip</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Подсчет объектов</span>
<span class="kt">int</span><span class="w"> </span><span class="n">objCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objcourse</span><span class="o">-&gt;</span><span class="n">getObjectCount</span><span class="p">(</span><span class="n">frameShip</span><span class="p">);</span>

<span class="c1">// Расчет курса</span>
<span class="kt">float</span><span class="w"> </span><span class="n">objAngle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objcourse</span><span class="o">-&gt;</span><span class="n">getObjectCourse</span><span class="p">(</span><span class="n">frameShip</span><span class="p">,</span><span class="w"> </span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">);</span>
</pre></div>
</div>
<p>Метод <code class="docutils literal notranslate"><span class="pre">getObjectCount</span></code> принимает на вход кадр видеофрейма в формате <code class="docutils literal notranslate"><span class="pre">cv::Mat</span></code>
и возвращает количество найденных объектов.</p>
<p>Метод <code class="docutils literal notranslate"><span class="pre">getObjectCourse</span></code> принимает кадр видеофрейма, разрешение камеры по горизонтали (в пикселях) и угол обзора камеры,
возвращая угловую поправку на текущий курс с учетом знака смещения.</p>
</section>
<section id="id70">
<h2>Пример использования модуля 3D сцены<a class="headerlink" href="#id70" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>L1000.bmp, R1000.bmp – набор исходных изображений;</p></li>
<li><p>(66a)_(960p)_NewCamStereoModule_Air.xml – xml-файл с параметрами камеры.</p></li>
</ul>
<p><strong>Подготовка входных данных</strong></p>
<p>Для подготовки входных параметров функции <code class="docutils literal notranslate"><span class="pre">readCameraStereoParametrsFromFile()</span></code>
необходимо загрузить исходные изображения и параметры камеры.
Также необходимо провести инициализацию параметров, как указано в примере использования.</p>
<p><strong>Основная функция</strong></p>
<p>Для определения координат 3D точек в сегментах идентифицированных объектов
и восстановления 3D сцены по двумерным изображениям используется функция:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrcv</span><span class="o">::</span><span class="n">find3dPointsInObjectsSegments</span><span class="p">(</span>
<span class="w">    </span><span class="n">inputImageCamera01</span><span class="p">,</span><span class="w"> </span><span class="n">inputImageCamera02</span><span class="p">,</span><span class="w"> </span><span class="n">cameraParameters</span><span class="p">,</span>
<span class="w">    </span><span class="n">inputImageCamera01Remap</span><span class="p">,</span><span class="w"> </span><span class="n">inputImageCamera02Remap</span><span class="p">,</span>
<span class="w">    </span><span class="n">settingsMetodDisparity</span><span class="p">,</span><span class="w"> </span><span class="n">disparityMap</span><span class="p">,</span><span class="w"> </span><span class="n">points3D</span><span class="p">,</span><span class="w"> </span><span class="n">replyMasks</span><span class="p">,</span>
<span class="w">    </span><span class="n">outputImage</span><span class="p">,</span><span class="w"> </span><span class="n">outputImage3dSceene</span><span class="p">,</span><span class="w"> </span><span class="n">parameters3dSceene</span><span class="p">,</span>
<span class="w">    </span><span class="n">filePathModelYoloNeuralNet</span><span class="p">,</span><span class="w"> </span><span class="n">filePathClasses</span><span class="p">,</span>
<span class="w">    </span><span class="n">limitOutPoints</span><span class="p">,</span><span class="w"> </span><span class="n">limitsOutlierArea</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Результаты работы</strong></p>
<a class="reference internal image-reference" href="_images/figure10_1.jpg"><img alt="Фотография экспериментального стенда и стереопара со стереокамеры" src="_images/figure10_1.jpg" style="width: 200px;" />
</a>
<a class="reference internal image-reference" href="_images/figure10_2.jpg"><img alt="Карта диспаратности и бинарные маски сегментов" src="_images/figure10_2.jpg" style="width: 200px;" />
</a>
<a class="reference internal image-reference" href="_images/figure10_3.jpg"><img alt="Результат обнаружения объектов с координатой по Z" src="_images/figure10_3.jpg" style="width: 200px;" />
</a>
<a class="inline-images reference internal image-reference" href="_images/figure10_4.jpg"><img alt="Изображения 3D сцены" class="inline-images" src="_images/figure10_4.jpg" style="width: 200px;" />
</a>
<a class="reference internal image-reference" href="_images/figure10_5.jpg"><img alt="Изображения 3D сцены" src="_images/figure10_5.jpg" style="width: 200px;" />
</a>
<p><strong>Фрагмент лог-файла</strong></p>
<p>Ниже приведён фрагмент из лог-файла библиотеки во время запуска примера использования:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>14:51:16 | INFO | === НОВЫЙ ЗАПУСК ===
14:51:16 | INFO | 1. Загрузка изображений из файла (успешно)
14:51:16 | INFO |     загружено изображение: ./files/L1000.bmp :: 960x600x3
14:51:16 | INFO |     загружено изображение: ./files/R1000.bmp :: 960x600x3
14:51:16 | INFO | 2. Загрузка параметров стереокамеры из файла (успешно)
14:51:16 | INFO | A1. Выравнивание изображения камера 01 (успешно)
14:51:16 | INFO | A2. Облако 3D точек сцены найдено (успешно)
14:51:16 | INFO |     points3D.numPoints0 = 312718
14:51:16 | INFO |     points3D.numPoints = 8018
...
14:51:17 | INFO | 4.8 Вывод проекции 3D сцены на экран (успешно)
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Author.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>